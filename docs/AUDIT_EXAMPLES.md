# Run Audit System - Output Examples

This document shows example outputs from the Run Audit System.

## JSONL Log Example (`user://audit_logs/run_xyz123_20250115_143052.jsonl`)

```jsonl
{"event":"run_start","run_id":"xyz123","seed":12345,"class":"arcanist","difficulty":"normal","ts":0}
{"event":"minute_tick","minute":1,"damage_dealt":2450,"damage_taken":85,"kills":12,"level":2,"ts":60000}
{"event":"weapon_hit","weapon_id":"fire_wand","damage":125,"crit":true,"element":"fire","ts":62340}
{"event":"level_up","level":3,"ts":95000}
{"event":"upgrade_pick","id":"damage_up_1","type":"upgrade","options":["damage_up_1","health_up_1","speed_up"],"ts":96000}
{"event":"minute_tick","minute":2,"damage_dealt":5800,"damage_taken":210,"kills":31,"level":4,"ts":120000}
{"event":"spike","type":"frame","value_ms":45.2,"context":"enemy_ai_batch","ts":135000}
{"event":"fusion_found","fusion_id":"inferno_orb","source":"chest","ts":180000}
{"event":"minute_tick","minute":3,"damage_dealt":12400,"damage_taken":380,"kills":58,"level":6,"ts":180000}
{"event":"run_end","run_id":"xyz123","duration_s":312,"outcome":"victory","final_level":8,"kills":127,"ts":312000}
```

## Markdown Report Example (`user://audit_reports/run_xyz123_20250115_143052.md`)

```markdown
# Run Audit Report
**Run ID:** xyz123  
**Seed:** 12345  
**Generated:** 2025-01-15 14:35:44

---

## Executive Summary
| Metric | Value |
|--------|-------|
| Duration | 5m 12s |
| Outcome | victory |
| Final Level | 8 |
| Total Kills | 127 |
| Damage Dealt | 45,230 |
| Damage Taken | 1,250 |
| Gold Earned | 892 |
| DPS (avg) | 144.6 |

---

## Build Final
**Class:** Arcanist  
**Difficulty:** normal

### Weapons
| Weapon | Level |
|--------|-------|
| fire_wand | 3 |
| arcane_orb | 2 |
| ice_wand | 1 |

### Key Passives
- damage_up_2 (Tier 2)
- crit_chance_1
- projectile_speed_1

---

## Damage by Weapon (Top 10)
| Weapon | Damage | Hits | Crits | DPS | % Total |
|--------|--------|------|-------|-----|---------|
| fire_wand | 18,450 | 412 | 89 | 59.1 | 40.8% |
| arcane_orb | 15,200 | 380 | 62 | 48.7 | 33.6% |
| ice_wand | 8,120 | 285 | 31 | 26.0 | 18.0% |
| orbital_fire | 3,460 | 120 | 12 | 11.1 | 7.6% |

---

## Dangerous Enemies (Top 10)
| Enemy | Damage to Player | Attacks | Avg Hit | Threat Rank |
|-------|------------------|---------|---------|-------------|
| Skeleton_Elite | 380 | 8 | 47.5 | 1 |
| FireMage | 290 | 12 | 24.2 | 2 |
| Skeleton | 215 | 18 | 11.9 | 3 |
| Slime | 185 | 22 | 8.4 | 4 |
| Bat | 120 | 15 | 8.0 | 5 |

---

## Progression
| Minute | Level | Kills | Damage Dealt | Damage Taken | DPS |
|--------|-------|-------|--------------|--------------|-----|
| 1 | 2 | 12 | 2,450 | 85 | 40.8 |
| 2 | 4 | 31 | 5,800 | 210 | 96.7 |
| 3 | 6 | 58 | 12,400 | 380 | 206.7 |
| 4 | 7 | 98 | 18,200 | 420 | 303.3 |
| 5 | 8 | 127 | 6,380 | 155 | 106.3 |

---

## Fusions & Chests
### Fusions Found
| Fusion | Source | Minute |
|--------|--------|--------|
| inferno_orb | chest | 3 |

### Chests Opened
- Total: 4
- Sources: elite (2), mini_boss (1), lucky (1)

---

## Scoring Breakdown
| Category | Points |
|----------|--------|
| Base Clear | 1000 |
| Kill Bonus | 254 |
| Time Bonus | 200 |
| No-Hit Bonus | 0 |
| **Total** | **1454** |

---

## Performance
### Top 5 Costly Scopes (Run)
| Scope | Total Time (ms) | Calls | Avg (ms) |
|-------|-----------------|-------|----------|
| enemy_ai | 1250.3 | 45000 | 0.028 |
| projectile_update | 890.5 | 32000 | 0.028 |
| damage_calc | 450.2 | 8500 | 0.053 |
| physics_step | 380.1 | 18720 | 0.020 |
| spawn_wave | 120.8 | 45 | 2.684 |

### Spikes Detected
| Type | Count | Worst (ms) | Context |
|------|-------|------------|---------|
| frame | 3 | 52.1 | enemy_ai_batch |
| gc | 1 | 38.2 | wave_spawn |

---

## Findings
### Issues
- **HIGH:** Frame spike of 52.1ms during enemy_ai_batch (target: 16.67ms)
- **MEDIUM:** DPS dropped 67% in minute 5 (final phase fatigue?)

### Recommendations
- Consider batching enemy AI updates
- Review wave 5 enemy composition

---
*Generated by RunAuditTracker v1.0*
```

## File Locations

- **JSONL Logs:** `user://audit_logs/run_{run_id}_{timestamp}.jsonl`
- **Markdown Reports:** `user://audit_reports/run_{run_id}_{timestamp}.md`

The `user://` path resolves to:
- **Windows:** `%APPDATA%/Godot/app_userdata/{project_name}/`
- **macOS:** `~/Library/Application Support/Godot/app_userdata/{project_name}/`
- **Linux:** `~/.local/share/godot/app_userdata/{project_name}/`

## Toggle

Set `RunAuditTracker.ENABLE_AUDIT = false` to disable all audit logging.
In release builds, this defaults to `false` automatically via `OS.is_debug_build()`.
